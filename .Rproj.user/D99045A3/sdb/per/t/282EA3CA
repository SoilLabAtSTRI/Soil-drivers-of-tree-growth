{
    "collab_server" : "",
    "contents" : "# Stepwise selection of the \"best\" model using the 2010 soil sampling.\n# All variables are standardised and 20 m around the plot edge is excluded to\n# eliminate edge effects with the light proxy\n\nlibrary( nlme )\nlibrary( car )\n\nsource( paste( mainSourcePath, \"Utilities.R\", sep=\"\") )\ndf <- GetGrowthModelData()  # From Utilities.R\n\n# The models need to be fitted with ML since the fixed effects\n# are being changed in each step of the process\n\n# The \"optimal\" random effects included the soil vars Mn and P.\n\nfixedEffect <- log(incgr) ~ Mn3 + M3P + K3 + Al3 + pH + l.dbh + l.light + l.slope + convex\nrandomEffect <- ~ l.dbh + l.light + Mn3 + M3P | sp\nmodCtrl <- lmeControl( maxIter=150, msMaxIter=150, niterEM=50, msMaxEval=250 )\nstartTime <- proc.time()\nmod.full <- lme( fixed=fixedEffect, random=randomEffect,\n                data=df, method=\"ML\", control=modCtrl,\n                weights=varExp() )\nprint( proc.time() - startTime )\nsummary( mod.full ) # Slope least significant\n\n# Remove slope\nfixedEffect <- log(incgr) ~ Mn3 + M3P + K3 + Al3 + pH + l.dbh + l.light + convex\nrandomEffect <- ~ l.dbh + l.light + Mn3 + M3P | sp\nstartTime <- proc.time()\nmod.a <- lme( fixed=fixedEffect, random=randomEffect,\n                      data=df, method=\"ML\", control=modCtrl,\n                      weights=varExp() )\nprint( proc.time() - startTime )\nsummary(mod.a) # pH least significant\n\n# Remove pH\nfixedEffect <- log(incgr) ~ Mn3 + M3P + K3 + Al3 + l.dbh + l.light + convex\nstartTime <- proc.time()\nmod.b <- lme( fixed=fixedEffect, random=randomEffect,\n                data=df, method=\"ML\", control=modCtrl,\n                weights=varExp() )\nprint( proc.time() - startTime )\nsummary(mod.b) # Convexity least significant\n\n# Remove convex\nfixedEffect <- log(incgr) ~ Mn3 + M3P + K3 + Al3 + l.dbh + l.light\nstartTime <- proc.time()\nmod.c <- lme( fixed=fixedEffect, random=randomEffect,\n                data=df, method=\"ML\", control=modCtrl,\n                weights=varExp() )\nprint( proc.time() - startTime )\nsummary(mod.c) # All signif\nanova( mod.b, mod.c ) # 2.c better, as expected\n\nvif( mod.c ) # K and Al have highest vif's - Al the highest\n\n# Test removing Al due to collinearity.\nfixedEffect <- log(incgr) ~ Mn3 + M3P + K3 + l.dbh + l.light\nstartTime <- proc.time()\nmod.d <- lme( fixed=fixedEffect, random=randomEffect,\n                data=df, method=\"ML\", control=modCtrl,\n                weights=varExp() )\nprint( proc.time() - startTime )\nsummary(mod.d) # P not signif\nanova( mod.b, mod.c, mod.d ) # mod.d much worse by AIC and BIC\n# suggesting that maintaining the collinear vars is better.\n\n# REML model\nfixedEffect <- log(incgr) ~ Mn3 + M3P + K3 + Al3 + l.dbh + l.light\nstartTime <- proc.time()\nmod.c.reml <- lme( fixed=fixedEffect, random=randomEffect,\n                data=df, method=\"REML\", control=modCtrl,\n                weights=varExp() )\nprint( proc.time() - startTime )\nsummary(mod.c.reml)\n\n# Save the model? If not, comment out\nsaveRDS( mod.c.reml, paste0( dataPath, \"Selected growth model.rds\" ) )\ndf.coef <- cbind( data.frame( sp=row.names(coef( mod.c.reml )) ), coef( mod.c.reml ) )\nwrite.csv( df.coef, paste0( dataPath, \"BCI growth model Coefs.csv\" ), row.names = F )\n\n\n",
    "created" : 1527228878736.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3142502309",
    "id" : "282EA3CA",
    "lastKnownWriteTime" : 1527241484,
    "last_content_update" : 1527241484544,
    "path" : "~/R/Github/Soil-drivers-of-tree-growth/Source/Stepwise model selection.R",
    "project_path" : "Source/Stepwise model selection.R",
    "properties" : {
    },
    "relative_order" : 6,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}